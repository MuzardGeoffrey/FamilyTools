<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Ajouter une EntrÃ©e - Tableau de Bord Comptable</title>
</head>
<body>
  <div class="app-container">
    <div class="header">
      <div>
        <h1>Ajouter une EntrÃ©e</h1>
        <div class="breadcrumb">
          <a href="#" onclick="goBack()">â† Tableau de bord</a>
          <span>/</span>
          <span>Nouvelle entrÃ©e</span>
        </div>
      </div>
    </div>
    
    <div class="navigation-tabs">
      <div class="tab active">Nouvelle entrÃ©e</div>
      <div class="tab">AperÃ§u</div>
    </div>

    <div class="form-tips">
      <h3>ğŸ’¡ Conseils pour une saisie optimale</h3>
      <ul>
        <li>Utilisez des descriptions claires et prÃ©cises</li>
        <li>VÃ©rifiez le montant avant validation</li>
        <li>Assignez correctement les personnes concernÃ©es</li>
        <li>La date par dÃ©faut est aujourd'hui</li>
      </ul>
    </div>
    
    <div class="card">
      <div class="card-header">
        <h2>Informations de l'entrÃ©e</h2>
        <p>Remplissez tous les champs obligatoires pour crÃ©er une nouvelle entrÃ©e comptable</p>
      </div>
      
      <form class="form-container" id="accountForm">
        <div class="toolbar">
          <h3 style="color: var(--text); margin: 0;">DÃ©tails de l'entrÃ©e</h3>
        </div>

        <div class="form-grid">
          <div class="form-group full-width">
            <label class="form-label">Description <span class="required">*</span></label>
            <input 
              type="text" 
              class="form-control" 
              id="description"
              placeholder="Ex: Facture Ã©lectricitÃ© mars 2025"
              required
            >
            <div class="validation-error">La description est obligatoire</div>
          </div>
          
          <div class="form-group">
            <label class="form-label">CatÃ©gorie <span class="required">*</span></label>
            <select class="form-select" id="category" required>
              <option value="">SÃ©lectionner une catÃ©gorie</option>
              <option value="Ã©lectricitÃ©">âš¡ Ã‰lectricitÃ©</option>
              <option value="loyer">ğŸ  Loyer</option>
              <option value="internet">ğŸŒ Internet</option>
              <option value="courses">ğŸ›’ Courses</option>
              <option value="mÃ©nage">ğŸ§¹ MÃ©nage</option>
              <option value="transport">ğŸš— Transport</option>
              <option value="restaurant">ğŸ½ï¸ Restaurant</option>
              <option value="autre">ğŸ“ Autre</option>
            </select>
            <div class="validation-error">Veuillez sÃ©lectionner une catÃ©gorie</div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Montant <span class="required">*</span></label>
            <div class="currency-input">
              <input 
                type="number" 
                step="0.01" 
                class="form-control" 
                id="amount"
                placeholder="0.00"
                min="0"
                required
              >
            </div>
            <div class="validation-error">Le montant doit Ãªtre supÃ©rieur Ã  0</div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Date</label>
            <input 
              type="date" 
              class="form-control" 
              id="date"
              required
            >
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">AssignÃ© Ã  <span class="required">*</span></label>
          <div class="assignee-section">
            <p style="margin-bottom: 10px; color: var(--text-muted); font-size: 14px;">
              SÃ©lectionnez les personnes concernÃ©es par cette dÃ©pense
            </p>
            <div class="assignee-grid">
              <label class="assignee-option">
                <input type="checkbox" name="assignee" value="pierre" id="assignee-pierre">
                <div class="summary-avatar">P</div>
                <div class="assignee-info">
                  <div class="assignee-name">Pierre</div>
                  <div class="assignee-role">Administrateur</div>
                </div>
              </label>
              
              <label class="assignee-option">
                <input type="checkbox" name="assignee" value="marie" id="assignee-marie">
                <div class="summary-avatar" style="background-color: var(--warning);">M</div>
                <div class="assignee-info">
                  <div class="assignee-name">Marie</div>
                  <div class="assignee-role">Utilisateur</div>
                </div>
              </label>
              
              <label class="assignee-option">
                <input type="checkbox" name="assignee" value="jean" id="assignee-jean">
                <div class="summary-avatar" style="background-color: var(--success);">J</div>
                <div class="assignee-info">
                  <div class="assignee-name">Jean</div>
                  <div class="assignee-role">Utilisateur</div>
                </div>
              </label>
            </div>
          </div>
          <div class="validation-error">Veuillez sÃ©lectionner au moins une personne</div>
        </div>
        
        <div class="preview-section" id="previewSection">
          <div class="preview-placeholder">
            <span style="color: var(--text-muted); font-size: 16px;">ğŸ‘ï¸ L'aperÃ§u apparaÃ®tra ici lors de la saisie</span>
          </div>
          <div class="preview-content" id="previewContent">
            <div class="preview-item">
              <strong id="previewDescription">Description</strong>
              <div class="preview-meta">
                <span class="tag-icon" id="previewCategoryIcon">ğŸ“</span>
                <span id="previewCategory">CatÃ©gorie</span> â€¢ 
                <span class="numeric-value" id="previewAmount">0,00 â‚¬</span> â€¢ 
                <span id="previewDate">Date</span>
              </div>
              <div style="margin-top: 10px;">
                <span style="font-size: 12px; color: var(--text-muted);">AssignÃ© Ã :</span>
                <div id="previewAssignees" style="margin-top: 5px;"></div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="toolbar">
          <div class="action-buttons">
            <button type="button" class="btn btn-secondary" onclick="resetForm()">
              ğŸ”„ RÃ©initialiser
            </button>
          </div>
          <div class="action-buttons">
            <button type="button" class="btn btn-secondary" onclick="goBack()">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">
              ğŸ’¾ Enregistrer l'entrÃ©e
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Initialisation de la date actuelle
    document.getElementById('date').valueAsDate = new Date();
    
    // Mapping des icÃ´nes par catÃ©gorie
    const categoryIcons = {
      'Ã©lectricitÃ©': 'âš¡',
      'loyer': 'ğŸ ',
      'internet': 'ğŸŒ',
      'courses': 'ğŸ›’',
      'mÃ©nage': 'ğŸ§¹',
      'transport': 'ğŸš—',
      'restaurant': 'ğŸ½ï¸',
      'autre': 'ğŸ“'
    };
    
    // Gestion de l'aperÃ§u en temps rÃ©el
    function updatePreview() {
      const description = document.getElementById('description').value;
      const category = document.getElementById('category').value;
      const amount = document.getElementById('amount').value;
      const date = document.getElementById('date').value;
      const assignees = Array.from(document.querySelectorAll('input[name="assignee"]:checked'))
        .map(checkbox => checkbox.nextElementSibling.nextElementSibling.querySelector('.assignee-name').textContent);
      
      const previewSection = document.getElementById('previewSection');
      const previewContent = document.getElementById('previewContent');
      const placeholder = previewSection.querySelector('.preview-placeholder');
      
      if (description || category || amount || assignees.length > 0) {
        placeholder.style.display = 'none';
        previewContent.classList.add('show');
        
        document.getElementById('previewDescription').textContent = description || 'Description';
        
        // Gestion de l'icÃ´ne et du texte de catÃ©gorie
        const categoryIcon = document.getElementById('previewCategoryIcon');
        if (category && categoryIcons[category]) {
          categoryIcon.textContent = categoryIcons[category];
        } else {
          categoryIcon.textContent = 'ğŸ“';
        }
        
        const categoryText = category ? document.querySelector(`option[value="${category}"]`).textContent.replace(/^[^\s]+ /, '') : 'CatÃ©gorie';
        document.getElementById('previewCategory').textContent = categoryText;
        
        const amountText = amount ? parseFloat(amount).toFixed(2) + ' â‚¬' : '0,00 â‚¬';
        document.getElementById('previewAmount').textContent = amountText;
        
        const dateText = date ? new Date(date).toLocaleDateString('fr-FR') : 'Date';
        document.getElementById('previewDate').textContent = dateText;
        
        // Affichage des assignÃ©s avec chips
        const assigneesContainer = document.getElementById('previewAssignees');
        if (assignees.length > 0) {
          assigneesContainer.innerHTML = assignees.map(name => 
            `<span class="assignee-chip">${name}</span>`
          ).join('');
        } else {
          assigneesContainer.innerHTML = '<span style="color: var(--text-muted); font-size: 12px;">Aucune personne assignÃ©e</span>';
        }
      } else {
        placeholder.style.display = 'block';
        previewContent.classList.remove('show');
      }
    }
    
    // Ã‰couteurs d'Ã©vÃ©nements pour l'aperÃ§u
    document.getElementById('description').addEventListener('input', updatePreview);
    document.getElementById('category').addEventListener('change', updatePreview);
    document.getElementById('amount').addEventListener('input', updatePreview);
    document.getElementById('date').addEventListener('change', updatePreview);
    document.querySelectorAll('input[name="assignee"]').forEach(checkbox => {
      checkbox.addEventListener('change', updatePreview);
    });
    
    // Validation du formulaire
    function validateForm() {
      let isValid = true;
      
      // Reset des erreurs
      document.querySelectorAll('.error').forEach(el => el.classList.remove('error'));
      
      // Validation description
      const description = document.getElementById('description');
      if (!description.value.trim()) {
        description.classList.add('error');
        isValid = false;
      }
      
      // Validation catÃ©gorie
      const category = document.getElementById('category');
      if (!category.value) {
        category.classList.add('error');
        isValid = false;
      }
      
      // Validation montant
      const amount = document.getElementById('amount');
      if (!amount.value || parseFloat(amount.value) <= 0) {
        amount.classList.add('error');
        isValid = false;
      }
      
      // Validation assignees
      const assignees = document.querySelectorAll('input[name="assignee"]:checked');
      const assigneeSection = document.querySelector('.assignee-section');
      if (assignees.length === 0) {
        assigneeSection.classList.add('error');
        isValid = false;
      }
      
      return isValid;
    }
    
    // Soumission du formulaire
    document.getElementById('accountForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      if (validateForm()) {
        // Simulation de l'enregistrement
        const formData = {
          description: document.getElementById('description').value,
          category: document.getElementById('category').value,
          amount: parseFloat(document.getElementById('amount').value),
          date: document.getElementById('date').value,
          assignees: Array.from(document.querySelectorAll('input[name="assignee"]:checked'))
            .map(checkbox => checkbox.value)
        };
        
        console.log('DonnÃ©es Ã  enregistrer:', formData);
        
        // Simulation d'un succÃ¨s
        alert('âœ… EntrÃ©e enregistrÃ©e avec succÃ¨s !');
        
        // Redirection vers le tableau de bord (simulation)
        // window.location.href = '/dashboard';
      }
    });
    
    // RÃ©initialisation du formulaire
    function resetForm() {
      if (confirm('ÃŠtes-vous sÃ»r de vouloir rÃ©initialiser le formulaire ?')) {
        document.getElementById('accountForm').reset();
        document.getElementById('date').valueAsDate = new Date();
        updatePreview();
        
        // Suppression des erreurs
        document.querySelectorAll('.error').forEach(el => el.classList.remove('error'));
      }
    }
    
    // Retour en arriÃ¨re
    function goBack() {
      if (confirm('ÃŠtes-vous sÃ»r de vouloir quitter ? Les modifications non sauvegardÃ©es seront perdues.')) {
        // window.history.back();
        console.log('Retour au tableau de bord');
      }
    }
    
    // Gestion des onglets
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', function() {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        this.classList.add('active');
        
        if (this.textContent.includes('AperÃ§u')) {
          updatePreview();
        }
      });
    });

    // Initialisation de l'aperÃ§u
    updatePreview();
  </script>
</body>
</html>