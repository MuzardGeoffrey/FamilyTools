<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Ajouter une Entr√©e - Tableau de Bord Comptable</title>
</head>
<body>
  <div class="app-container">
    <div class="header">
      <div>
        <h1>Ajouter une Entr√©e</h1>
        <div class="breadcrumb">
          <a href="#" onclick="goBack()">‚Üê Tableau de bord</a>
          <span>/</span>
          <span>Nouvelle entr√©e</span>
        </div>
      </div>
    </div>
    
    <div class="navigation-tabs">
      <div class="tab active">Nouvelle entr√©e</div>
      <div class="tab">Aper√ßu</div>
    </div>

    <div class="form-tips">
      <h3>üí° Conseils pour une saisie optimale</h3>
      <ul>
        <li>Utilisez des descriptions claires et pr√©cises</li>
        <li>V√©rifiez le montant avant validation</li>
        <li>Assignez correctement les personnes concern√©es</li>
        <li>La date par d√©faut est aujourd'hui</li>
      </ul>
    </div>
    
    <div class="card">
      <div class="card-header">
        <h2>Informations de l'entr√©e</h2>
        <p>Remplissez tous les champs obligatoires pour cr√©er une nouvelle entr√©e comptable</p>
      </div>
      
      <form class="form-container" id="accountForm" [formGroup]="enter_form" (ngsubmit)="createEnter()">
        <div class="toolbar">
          <h3 style="color: var(--text); margin: 0;">D√©tails de l'entr√©e</h3>
        </div>

        <div class="form-grid">
          <div class="form-group full-width">
            <label class="form-label">nom <span class="required">*</span></label>
            <input 
              type="text" 
              class="form-control" 
              id="name"
              placeholder="Entrez un nom"
              formControlName="name"
              required
            >
            <div class="validation-error">La description est obligatoire</div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Cat√©gorie <span class="required">*</span></label>
            <select class="form-select" id="category" required>
              <option value="">S√©lectionner une cat√©gorie</option>
              @for (tag of this.service.all_tag; track $index) {
                <option value="{{ tag.id }}"> {{ tag.name }}</option>
              }
            </select>
            <div class="validation-error">Veuillez s√©lectionner une cat√©gorie</div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Montant total<span class="required">*</span></label>
            <div class="currency-input">
              <input 
                type="number" 
                step="0.01" 
                class="form-control" 
                id="totalValue"
                placeholder="0.00"
                formControlName="totalValue"
                required
              >
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Date</label>
            <input 
              type="date" 
              class="form-control" 
              id="date"
              formControlName="date"
              required
            >
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Assign√© √† <span class="required">*</span></label>

          @for (user of this.lines.value; track $index) {
            <!-- TODO : faire le reste du formulaire ( voir avec les formulaires bs√© sur des models) -->
          }

          <!-- <div class="assignee-section">
            <p style="margin-bottom: 10px; color: var(--text-muted); font-size: 14px;">
              S√©lectionnez les personnes concern√©es par cette d√©pense
            </p>
            <div class="assignee-grid">
              <label class="assignee-option">
                <input type="checkbox" name="assignee" value="pierre" id="assignee-pierre">
                <div class="summary-avatar">P</div>
                <div class="assignee-info">
                  <div class="assignee-name">Pierre</div>
                  <div class="assignee-role">Administrateur</div>
                </div>
              </label>
              
              <label class="assignee-option">
                <input type="checkbox" name="assignee" value="marie" id="assignee-marie">
                <div class="summary-avatar" style="background-color: var(--warning);">M</div>
                <div class="assignee-info">
                  <div class="assignee-name">Marie</div>
                  <div class="assignee-role">Utilisateur</div>
                </div>
              </label>
              
              <label class="assignee-option">
                <input type="checkbox" name="assignee" value="jean" id="assignee-jean">
                <div class="summary-avatar" style="background-color: var(--success);">J</div>
                <div class="assignee-info">
                  <div class="assignee-name">Jean</div>
                  <div class="assignee-role">Utilisateur</div>
                </div>
              </label>
            </div>
          </div>
          <div class="validation-error">Veuillez s√©lectionner au moins une personne</div> -->
        </div>
        
        <div class="preview-section" id="previewSection">
          <div class="preview-placeholder">
            <span style="color: var(--text-muted); font-size: 16px;">üëÅÔ∏è L'aper√ßu appara√Ætra ici lors de la saisie</span>
          </div>
          <div class="preview-content" id="previewContent">
            <div class="preview-item">
              <strong id="previewDescription">Description</strong>
              <div class="preview-meta">
                <span class="tag-icon" id="previewCategoryIcon">üìù</span>
                <span id="previewCategory">Cat√©gorie</span> ‚Ä¢ 
                <span class="numeric-value" id="previewAmount">0,00 ‚Ç¨</span> ‚Ä¢ 
                <span id="previewDate">Date</span>
              </div>
              <div style="margin-top: 10px;">
                <span style="font-size: 12px; color: var(--text-muted);">Assign√© √†:</span>
                <div id="previewAssignees" style="margin-top: 5px;"></div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="toolbar">
          <div class="action-buttons">
            <button type="button" class="btn btn-secondary" onclick="resetForm()">
              üîÑ R√©initialiser
            </button>
          </div>
          <div class="action-buttons">
            <button type="button" class="btn btn-secondary" onclick="goBack()">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">
              üíæ Enregistrer l'entr√©e
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- <script>
    // Initialisation de la date actuelle
    document.getElementById('date').valueAsDate = new Date();
    
    // Mapping des ic√¥nes par cat√©gorie
    const categoryIcons = {
      '√©lectricit√©': '‚ö°',
      'loyer': 'üè†',
      'internet': 'üåê',
      'courses': 'üõí',
      'm√©nage': 'üßπ',
      'transport': 'üöó',
      'restaurant': 'üçΩÔ∏è',
      'autre': 'üìù'
    };
    
    // Gestion de l'aper√ßu en temps r√©el
    function updatePreview() {
      const description = document.getElementById('description').value;
      const category = document.getElementById('category').value;
      const amount = document.getElementById('amount').value;
      const date = document.getElementById('date').value;
      const assignees = Array.from(document.querySelectorAll('input[name="assignee"]:checked'))
        .map(checkbox => checkbox.nextElementSibling.nextElementSibling.querySelector('.assignee-name').textContent);
      
      const previewSection = document.getElementById('previewSection');
      const previewContent = document.getElementById('previewContent');
      const placeholder = previewSection.querySelector('.preview-placeholder');
      
      if (description || category || amount || assignees.length > 0) {
        placeholder.style.display = 'none';
        previewContent.classList.add('show');
        
        document.getElementById('previewDescription').textContent = description || 'Description';
        
        // Gestion de l'ic√¥ne et du texte de cat√©gorie
        const categoryIcon = document.getElementById('previewCategoryIcon');
        if (category && categoryIcons[category]) {
          categoryIcon.textContent = categoryIcons[category];
        } else {
          categoryIcon.textContent = 'üìù';
        }
        
        const categoryText = category ? document.querySelector(`option[value="${category}"]`).textContent.replace(/^[^\s]+ /, '') : 'Cat√©gorie';
        document.getElementById('previewCategory').textContent = categoryText;
        
        const amountText = amount ? parseFloat(amount).toFixed(2) + ' ‚Ç¨' : '0,00 ‚Ç¨';
        document.getElementById('previewAmount').textContent = amountText;
        
        const dateText = date ? new Date(date).toLocaleDateString('fr-FR') : 'Date';
        document.getElementById('previewDate').textContent = dateText;
        
        // Affichage des assign√©s avec chips
        const assigneesContainer = document.getElementById('previewAssignees');
        if (assignees.length > 0) {
          assigneesContainer.innerHTML = assignees.map(name => 
            `<span class="assignee-chip">${name}</span>`
          ).join('');
        } else {
          assigneesContainer.innerHTML = '<span style="color: var(--text-muted); font-size: 12px;">Aucune personne assign√©e</span>';
        }
      } else {
        placeholder.style.display = 'block';
        previewContent.classList.remove('show');
      }
    }
    
    // √âcouteurs d'√©v√©nements pour l'aper√ßu
    document.getElementById('description').addEventListener('input', updatePreview);
    document.getElementById('category').addEventListener('change', updatePreview);
    document.getElementById('amount').addEventListener('input', updatePreview);
    document.getElementById('date').addEventListener('change', updatePreview);
    document.querySelectorAll('input[name="assignee"]').forEach(checkbox => {
      checkbox.addEventListener('change', updatePreview);
    });
    
    // Validation du formulaire
    function validateForm() {
      let isValid = true;
      
      // Reset des erreurs
      document.querySelectorAll('.error').forEach(el => el.classList.remove('error'));
      
      // Validation description
      const description = document.getElementById('description');
      if (!description.value.trim()) {
        description.classList.add('error');
        isValid = false;
      }
      
      // Validation cat√©gorie
      const category = document.getElementById('category');
      if (!category.value) {
        category.classList.add('error');
        isValid = false;
      }
      
      // Validation montant
      const amount = document.getElementById('amount');
      if (!amount.value || parseFloat(amount.value) <= 0) {
        amount.classList.add('error');
        isValid = false;
      }
      
      // Validation assignees
      const assignees = document.querySelectorAll('input[name="assignee"]:checked');
      const assigneeSection = document.querySelector('.assignee-section');
      if (assignees.length === 0) {
        assigneeSection.classList.add('error');
        isValid = false;
      }
      
      return isValid;
    }
    
    // Soumission du formulaire
    document.getElementById('accountForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      if (validateForm()) {
        // Simulation de l'enregistrement
        const formData = {
          description: document.getElementById('description').value,
          category: document.getElementById('category').value,
          amount: parseFloat(document.getElementById('amount').value),
          date: document.getElementById('date').value,
          assignees: Array.from(document.querySelectorAll('input[name="assignee"]:checked'))
            .map(checkbox => checkbox.value)
        };
        
        console.log('Donn√©es √† enregistrer:', formData);
        
        // Simulation d'un succ√®s
        alert('‚úÖ Entr√©e enregistr√©e avec succ√®s !');
        
        // Redirection vers le tableau de bord (simulation)
        // window.location.href = '/dashboard';
      }
    });
    
    // R√©initialisation du formulaire
    function resetForm() {
      if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser le formulaire ?')) {
        document.getElementById('accountForm').reset();
        document.getElementById('date').valueAsDate = new Date();
        updatePreview();
        
        // Suppression des erreurs
        document.querySelectorAll('.error').forEach(el => el.classList.remove('error'));
      }
    }
    
    // Retour en arri√®re
    function goBack() {
      if (confirm('√ätes-vous s√ªr de vouloir quitter ? Les modifications non sauvegard√©es seront perdues.')) {
        // window.history.back();
        console.log('Retour au tableau de bord');
      }
    }
    
    // Gestion des onglets
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', function() {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        this.classList.add('active');
        
        if (this.textContent.includes('Aper√ßu')) {
          updatePreview();
        }
      });
    });

    // Initialisation de l'aper√ßu
    updatePreview();
  </script> -->
</body>
</html>